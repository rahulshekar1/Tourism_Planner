<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Tables - SB Admin</title>
        <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
        <link href="css/styles.css" rel="stylesheet" />
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
        <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet" />
        <!-- Mapbox Assembly -->
        <link href="https://api.mapbox.com/mapbox-assembly/v1.3.0/assembly.min.css" rel="stylesheet" />
        <script src="https://api.mapbox.com/mapbox-assembly/v1.3.0/assembly.js"></script>
        <style>
            body {
              margin: 0;
              padding: 0;
            }
        
            #map {
              position: absolute;
              top: 0;
              bottom: 0;
              width: 1695px;
            }
        </style>
    </head>
    <body class="sb-nav-fixed">
        <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
            <!-- Navbar Brand-->
            <a class="navbar-brand ps-3" href="index.html">Karnataka Trip Planner</a>
            <!-- Sidebar Toggle-->
            <!-- <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button> -->
            <!-- Navbar Search-->
            <!-- <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
                <div class="input-group">
                    <input class="form-control" type="text" placeholder="Search for..." aria-label="Search for..." aria-describedby="btnNavbarSearch" />
                    <button class="btn btn-primary" id="btnNavbarSearch" type="button"><i class="fas fa-search"></i></button>
                </div>
            </form> -->
            <!-- Navbar-->
            <!-- <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#!">Settings</a></li>
                        <li><a class="dropdown-item" href="#!">Activity Log</a></li>
                        <li><hr class="dropdown-divider" /></li>
                        <li><a class="dropdown-item" href="#!">Logout</a></li>
                    </ul>
                </li>
            </ul> -->
        </nav>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                    <div class="sb-sidenav-menu">
                        <div class="nav">
                            <!-- <div class="sb-sidenav-menu-heading">Core</div> -->
                            <a class="nav-link" href="index.html">
                                <div class="sb-nav-link-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sign-turn-slight-right-fill" viewBox="0 0 16 16">
                                    <path d="M6.95.435c.58-.58 1.52-.58 2.1 0l6.515 6.516c.58.58.58 1.519 0 2.098L9.05 15.565c-.58.58-1.519.58-2.098 0L.435 9.05a1.482 1.482 0 0 1 0-2.098L6.95.435Zm1.385 6.547.8 1.386a.25.25 0 0 0 .451-.039l1.06-2.882a.25.25 0 0 0-.192-.333l-3.026-.523a.25.25 0 0 0-.26.371l.667 1.154-.621.373A2.5 2.5 0 0 0 6 8.632V11h1V8.632a1.5 1.5 0 0 1 .728-1.286l.607-.364Z"/>
                                  </svg></i></div>
                                  Direction
                            </a>
                            <a class="nav-link" href="nearme.html">
                                <div class="sb-nav-link-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-fill" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.319 1.319 0 0 0-.37.265.301.301 0 0 0-.057.09V14l.002.008a.147.147 0 0 0 .016.033.617.617 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.619.619 0 0 0 .146-.15.148.148 0 0 0 .015-.033L12 14v-.004a.301.301 0 0 0-.057-.09 1.318 1.318 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465-1.281 0-2.462-.172-3.34-.465-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411z"/>
                                  </svg></div>
                                NEAR ME!
                            </a>
                        <!-- </div>
                    </div> --> 
                    <!-- <div class="sb-sidenav-footer">
                        <div class="small">Logged in as:</div>
                        Start Bootstrap
                    </div> -->
                </nav>
            </div>
            <div id="layoutSidenav_content">
                <main>
                    <div id="map"></div>
                    <div class="absolute fl my24 mx24 py24 px24 bg-blue-faint round">
                        <form id="params">
                        <h4 class="txt-m txt-bold mb6">Choose a travel mode:</h4>
                        <div class="mb12 mr12 toggle-group align-center">
                            <label class="toggle-container">
                            <input name="profile" type="radio" value="walking" />
                            <div class="toggle toggle--active-null toggle--null">Walking</div>
                            </label>
                            <label class="toggle-container">
                            <input name="profile" type="radio" value="cycling" checked />
                            <div class="toggle toggle--active-null toggle--null">Cycling</div>
                            </label>
                            <label class="toggle-container">
                            <input name="profile" type="radio" value="driving" />
                            <div class="toggle toggle--active-null toggle--null">Driving</div>
                            </label>
                            <label class="toggle-container">
                            
                        </div>
                        <h4 class="txt-m txt-bold mb6">Choose a maximum duration:</h4>
                        <div class="mb12 mr12 toggle-group align-center">
                            <label class="toggle-container">
                            <input name="duration" type="radio" value="10" checked />
                            <div class="toggle toggle--active-null toggle--null">10 min</div>
                            </label>
                            <label class="toggle-container">
                            <input name="duration" type="radio" value="20" />
                            <div class="toggle toggle--active-null toggle--null">20 min</div>
                            </label>
                            <label class="toggle-container">
                            <input name="duration" type="radio" value="30" />
                            <div class="toggle toggle--active-null toggle--null">30 min</div>
                            </label>
                            <label class="toggle-container">
                            <input name="duration" type="radio" value="60" />
                            <div class="toggle toggle--active-null toggle--null">60 min</div>
                            </label>
                        </div>
                        </form>
                    </div>

                    <script>
                        mapboxgl.accessToken = 'pk.eyJ1IjoicmFodWxzaGVrYXIzNiIsImEiOiJjbGkwN2V2bzQwMWFqM2VxdHN0d2JqYmNjIn0.80D19gZMovIsTUul0dxRfg';

                        const map = new mapboxgl.Map({
                        container: 'map', // container id
                        style: 'mapbox://styles/rahulshekar36/cliyelkle015i01qv2kytc8o1', // stylesheet
                        center: [76.643372,12.321219], // starting position [lng, lat]
                        zoom: 11.5 // starting zoom
                        });

                        // Target the params form in the HTML
                        const params = document.getElementById('params');

                        // Create variables to use in getIso()
                        const urlBase = 'https://api.mapbox.com/isochrone/v1/mapbox/';
                        let lon = 76.643372;
                        let lat = 12.321219;
                        let profile = 'cycling';
                        let minutes = 10;
                        let colour = "ff0000";
                        // Set up a marker that you can use to show the query's coordinates
                        const marker = new mapboxgl.Marker({
                        'color': '#314ccd',
                        'draggable': true
                        });

                        // Create a function to update the marker's coordinates and trigger the isochrone generation
                        function updateMarker() {
                        const lngLat = marker.getLngLat();
                        lon = lngLat.lng;
                        lat = lngLat.lat;
                        getIso();
                        }

                        // Create a function that sets up the Isochrone API query then makes a fetch call
                        async function getIso() {
                        const query = await fetch(
                            `${urlBase}${profile}/${lon},${lat}?contours_minutes=${minutes}&polygons=true&access_token=${mapboxgl.accessToken}`,
                            { method: 'GET' }
                        );
                        const data = await query.json();
                        // Set the 'iso' source's data to what's returned by the API query
                        map.getSource('iso').setData(data);
                        }

                        // When a user changes the value of profile or duration by clicking a button, change the parameter's value and make the API query again
                        params.addEventListener('change', (event) => {
                        console.log(event.target.value);
                        if (event.target.name === 'profile') {
                            profile = event.target.value;
                        } else if (event.target.name === 'duration') {
                            minutes = event.target.value;
                        }
                        getIso();
                        });

                        map.on('load', () => {
                        // When the map loads, add the source and layer
                        map.addSource('iso', {
                            type: 'geojson',
                            data: {
                            'type': 'FeatureCollection',
                            'features': []
                            }
                        });

                        map.addLayer(
                            {
                            'id': 'isoLayer',
                            'type': 'fill',
                            'source': 'iso',
                            'layout': {},
                            'paint': {
                                'fill-color': '#5a3fc0',
                                'fill-opacity': 0.3
                            }
                            },
                            'poi-label'
                        );

                        // Initialize the marker at the query coordinates
                        marker.setLngLat({ lng: lon, lat: lat }).addTo(map);

                        // Update the marker and isochrone when the marker is dragged
                        if (navigator.geolocation) {
                            navigator.geolocation.getCurrentPosition((position) => {
                            // Update the marker's position to the user's location
                            lon = position.coords.longitude;
                            lat = position.coords.latitude;
                            marker.setLngLat({ lng: lon, lat: lat }).addTo(map);
                            map.setCenter([lon, lat]);
                            getIso();
                            });
                        }

                        // Update the marker and isochrone when the marker is dragged
                        marker.on('dragend', updateMarker);

                        // Make the initial API call
                        getIso();
                        });
                    </script>
                </main>
                <footer class="py-4 bg-light mt-auto">
                    <div class="container-fluid px-4">
                        <div class="d-flex align-items-center justify-content-between small">
                            <div class="text-muted">Copyright &copy; Your Website 2023</div>
                            <div>
                                <a href="#">Privacy Policy</a>
                                &middot;
                                <a href="#">Terms &amp; Conditions</a>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="js/scripts.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
        <script src="js/datatables-simple-demo.js"></script>
    </body>
</html>
